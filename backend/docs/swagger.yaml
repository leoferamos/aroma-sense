basePath: /
definitions:
  dto.AddToCartRequest:
    properties:
      product_slug:
        type: string
      quantity:
        minimum: 1
        type: integer
    required:
    - product_slug
    - quantity
    type: object
  dto.AdminDeactivateUserRequest:
    properties:
      notes:
        example: User violated terms of service by posting inappropriate content
        maxLength: 500
        type: string
      reason:
        enum:
        - violation_of_terms
        - privacy_violation
        - fraud_suspicion
        - account_compromise
        - underage_user
        - duplicate_account
        example: violation_of_terms
        type: string
      suspension_until:
        example: "2024-12-31T23:59:59Z"
        type: string
    required:
    - reason
    type: object
  dto.AdminOrderItem:
    properties:
      created_at:
        type: string
      id:
        example: 1
        type: integer
      public_id:
        example: uuid
        type: string
      status:
        example: pending
        type: string
      total_amount:
        example: 123.45
        type: number
      user_id:
        example: uuid
        type: string
    type: object
  dto.AdminOrdersResponse:
    properties:
      meta:
        properties:
          pagination:
            $ref: '#/definitions/dto.PaginationMeta'
          stats:
            $ref: '#/definitions/dto.StatsMeta'
        type: object
      orders:
        items:
          $ref: '#/definitions/dto.AdminOrderItem'
        type: array
    type: object
  dto.AdminReactivateUserRequest:
    properties:
      reason:
        example: Contestation reviewed and approved - account reactivated
        maxLength: 200
        minLength: 10
        type: string
    required:
    - reason
    type: object
  dto.AdminUserResponse:
    properties:
      contestation_deadline:
        type: string
      created_at:
        type: string
      deactivated_at:
        type: string
      deactivated_by:
        type: string
      deactivation_notes:
        type: string
      deactivation_reason:
        type: string
      display_name:
        type: string
      id:
        type: integer
      last_login_at:
        type: string
      masked_email:
        type: string
      public_id:
        type: string
      reactivation_requested:
        type: boolean
      role:
        type: string
      suspension_until:
        type: string
    type: object
  dto.AuditLogListResponse:
    properties:
      audit_logs:
        items:
          $ref: '#/definitions/dto.AuditLogResponse'
        type: array
      limit:
        type: integer
      offset:
        type: integer
      total:
        type: integer
    type: object
  dto.AuditLogResponse:
    properties:
      action:
        $ref: '#/definitions/model.AuditAction'
      actor:
        $ref: '#/definitions/dto.UserBasicResponse'
      actor_id:
        type: integer
      actor_type:
        type: string
      compliance:
        type: string
      created_at:
        type: string
      details:
        additionalProperties: true
        type: object
      id:
        type: integer
      new_values:
        additionalProperties: true
        type: object
      old_values:
        additionalProperties: true
        type: object
      public_id:
        type: string
      resource:
        type: string
      resource_id:
        type: string
      severity:
        type: string
      timestamp:
        type: string
      user:
        $ref: '#/definitions/dto.UserBasicResponse'
      user_id:
        type: integer
    type: object
  dto.AuditLogSummaryResponse:
    properties:
      actions_by_type:
        additionalProperties:
          format: int64
          type: integer
        type: object
      generated_at:
        type: string
      recent_actions:
        items:
          $ref: '#/definitions/dto.AuditLogResponse'
        type: array
      total_actions:
        type: integer
      user_activity:
        additionalProperties:
          format: int64
          type: integer
        type: object
    type: object
  dto.CartItemResponse:
    properties:
      price:
        type: number
      product:
        $ref: '#/definitions/dto.ProductResponse'
      quantity:
        type: integer
      total:
        type: number
    type: object
  dto.CartResponse:
    properties:
      item_count:
        type: integer
      items:
        items:
          $ref: '#/definitions/dto.CartItemResponse'
        type: array
      total:
        type: number
    type: object
  dto.ChangePasswordRequest:
    properties:
      current_password:
        example: oldpassword123
        type: string
      new_password:
        example: newpassword123
        minLength: 8
        type: string
    required:
    - current_password
    - new_password
    type: object
  dto.ChatRequest:
    properties:
      history:
        items:
          type: string
        type: array
      message:
        type: string
      session_id:
        type: string
    type: object
  dto.ChatResponse:
    properties:
      follow_up_hint:
        type: string
      reply:
        type: string
      suggestions:
        items:
          $ref: '#/definitions/dto.RecommendSuggestion'
        type: array
    type: object
  dto.ContestationRequest:
    properties:
      reason:
        example: I believe my account was deactivated by mistake. I did not violate
          any terms of service.
        maxLength: 500
        minLength: 10
        type: string
    required:
    - reason
    type: object
  dto.CreateOrderFromCartRequest:
    properties:
      payment_method:
        enum:
        - credit_card
        - debit_card
        - pix
        - boleto
        example: pix
        type: string
      shipping_address:
        example: Rua Example, 123, São Paulo - SP, 01234-567
        type: string
      shipping_selection:
        $ref: '#/definitions/dto.ShippingSelection'
    required:
    - payment_method
    - shipping_address
    type: object
  dto.CreateUserRequest:
    properties:
      email:
        example: user@example.com
        format: email
        type: string
      password:
        minLength: 8
        type: string
    required:
    - email
    - password
    type: object
  dto.DeleteAccountRequest:
    properties:
      confirmation:
        example: DELETE_MY_ACCOUNT or EXCLUIR_MINHA_CONTA
        type: string
    required:
    - confirmation
    type: object
  dto.ErrorResponse:
    properties:
      error:
        example: error message
        type: string
    type: object
  dto.LoginRequest:
    properties:
      email:
        example: user@example.com
        format: email
        type: string
      password:
        type: string
    required:
    - email
    - password
    type: object
  dto.LoginResponse:
    properties:
      access_token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
      message:
        example: Login successful
        type: string
      user:
        $ref: '#/definitions/dto.UserResponse'
    type: object
  dto.MessageResponse:
    properties:
      message:
        example: success message
        type: string
    type: object
  dto.OrderItemResponse:
    properties:
      price_at_purchase:
        type: number
      product_image_url:
        type: string
      product_name:
        type: string
      product_slug:
        type: string
      quantity:
        type: integer
      subtotal:
        type: number
    type: object
  dto.OrderResponse:
    properties:
      created_at:
        type: string
      item_count:
        type: integer
      items:
        items:
          $ref: '#/definitions/dto.OrderItemResponse'
        type: array
      payment_method:
        type: string
      public_id:
        type: string
      shipping_address:
        type: string
      shipping_carrier:
        type: string
      shipping_estimated_delivery:
        type: string
      shipping_price:
        type: number
      shipping_service_code:
        type: string
      shipping_status:
        type: string
      shipping_tracking:
        type: string
      status:
        type: string
      total_amount:
        type: number
      updated_at:
        type: string
    type: object
  dto.PaginationMeta:
    properties:
      page:
        example: 1
        type: integer
      per_page:
        example: 25
        type: integer
      total_count:
        example: 247
        type: integer
      total_pages:
        example: 10
        type: integer
    type: object
  dto.ProductListResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/dto.ProductResponse'
        type: array
      limit:
        type: integer
      page:
        type: integer
      total:
        type: integer
    type: object
  dto.ProductResponse:
    properties:
      accords:
        example:
        - '["woody"'
        - '"citrus"]'
        items:
          type: string
        type: array
      brand:
        example: Dior
        type: string
      can_review:
        type: boolean
      cannot_review_reason:
        type: string
      category:
        example: Eau de Parfum
        type: string
      created_at:
        example: "2025-09-28T10:00:00Z"
        type: string
      description:
        example: A fresh and woody fragrance
        type: string
      gender:
        example: unisex
        type: string
      id:
        example: 1
        type: integer
      image_url:
        example: https://example.com/image.jpg
        type: string
      intensity:
        example: moderate
        type: string
      name:
        example: Sauvage
        type: string
      notes_base:
        example:
        - '["ambroxan"]'
        items:
          type: string
        type: array
      notes_heart:
        example:
        - '["lavender"]'
        items:
          type: string
        type: array
      notes_top:
        example:
        - '["bergamot"]'
        items:
          type: string
        type: array
      occasions:
        example:
        - '["work"'
        - '"night out"]'
        items:
          type: string
        type: array
      price:
        example: 299.99
        type: number
      price_range:
        example: premium
        type: string
      seasons:
        example:
        - '["summer"'
        - '"spring"]'
        items:
          type: string
        type: array
      slug:
        example: dior-sauvage
        type: string
      stock_quantity:
        example: 50
        type: integer
      thumbnail_url:
        example: https://example.com/image_thumb.jpg
        type: string
      updated_at:
        example: "2025-09-28T10:00:00Z"
        type: string
      weight:
        example: 100
        type: number
    type: object
  dto.ProfileResponse:
    properties:
      created_at:
        type: string
      display_name:
        type: string
      email:
        type: string
      public_id:
        type: string
      role:
        type: string
    type: object
  dto.RecommendRequest:
    properties:
      history:
        items:
          type: string
        type: array
      limit:
        type: integer
      message:
        type: string
    type: object
  dto.RecommendResponse:
    properties:
      reasoning:
        type: string
      suggestions:
        items:
          $ref: '#/definitions/dto.RecommendSuggestion'
        type: array
    type: object
  dto.RecommendSuggestion:
    properties:
      brand:
        type: string
      id:
        type: integer
      name:
        type: string
      price:
        type: number
      reason:
        type: string
      slug:
        type: string
      thumbnail_url:
        type: string
    type: object
  dto.ResetPasswordConfirmRequest:
    properties:
      code:
        example: "123456"
        type: string
      email:
        example: user@example.com
        type: string
      new_password:
        example: NewPass123
        minLength: 8
        type: string
    required:
    - code
    - email
    - new_password
    type: object
  dto.ResetPasswordRequestRequest:
    properties:
      email:
        example: user@example.com
        type: string
    required:
    - email
    type: object
  dto.ReviewListResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/dto.ReviewResponse'
        type: array
      limit:
        type: integer
      page:
        type: integer
      total:
        type: integer
    type: object
  dto.ReviewReportAdminItem:
    properties:
      created_at:
        type: string
      id:
        type: string
      reason_category:
        type: string
      reason_text:
        type: string
      reported_by:
        type: string
      reporter:
        $ref: '#/definitions/dto.ReviewReportAdminReporter'
      review:
        $ref: '#/definitions/dto.ReviewReportAdminReview'
      review_id:
        type: string
      status:
        type: string
    type: object
  dto.ReviewReportAdminReporter:
    properties:
      display_name:
        type: string
      public_id:
        type: string
    type: object
  dto.ReviewReportAdminResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/dto.ReviewReportAdminItem'
        type: array
      limit:
        type: integer
      offset:
        type: integer
      total:
        type: integer
    type: object
  dto.ReviewReportAdminReview:
    properties:
      comment:
        type: string
      id:
        type: string
      rating:
        type: integer
      user_id:
        type: string
    type: object
  dto.ReviewReportRequest:
    properties:
      category:
        type: string
      reason:
        maxLength: 500
        type: string
    required:
    - category
    type: object
  dto.ReviewReportResolveRequest:
    properties:
      action:
        enum:
        - accept
        - reject
        type: string
      deactivate_user:
        type: boolean
      notes:
        type: string
      suspension_until:
        type: string
    required:
    - action
    type: object
  dto.ReviewRequest:
    properties:
      comment:
        maxLength: 500
        type: string
      rating:
        maximum: 5
        minimum: 1
        type: integer
    required:
    - rating
    type: object
  dto.ReviewResponse:
    properties:
      author_display:
        type: string
      author_id:
        type: string
      comment:
        type: string
      created_at:
        type: string
      id:
        type: string
      rating:
        type: integer
    type: object
  dto.ReviewSummary:
    properties:
      average:
        type: number
      count:
        type: integer
      distribution:
        additionalProperties:
          type: integer
        type: object
    type: object
  dto.ShippingOption:
    properties:
      carrier:
        type: string
      estimated_days:
        type: integer
      price:
        type: number
      service_code:
        type: string
    type: object
  dto.ShippingSelection:
    properties:
      carrier:
        example: Correios
        type: string
      estimated_days:
        example: 2
        type: integer
      price:
        example: 24.9
        type: number
      quote_id:
        example: q_abc123
        type: string
      service_code:
        example: SEDEX
        type: string
    required:
    - carrier
    - price
    - service_code
    type: object
  dto.StatsMeta:
    properties:
      average_order_value:
        example: 49.95
        type: number
      total_revenue:
        example: 12345.67
        type: number
    type: object
  dto.UpdateCartItemRequest:
    properties:
      quantity:
        minimum: 0
        type: integer
    required:
    - quantity
    type: object
  dto.UpdateProductRequest:
    type: object
  dto.UpdateProfileRequest:
    properties:
      display_name:
        example: João Santos
        maxLength: 50
        minLength: 2
        type: string
    required:
    - display_name
    type: object
  dto.UpdateRoleRequest:
    properties:
      role:
        enum:
        - admin
        - client
        example: admin
        type: string
    required:
    - role
    type: object
  dto.UserBasicResponse:
    properties:
      display_name:
        type: string
      email:
        type: string
      id:
        type: integer
      public_id:
        type: string
      role:
        type: string
    type: object
  dto.UserExportResponse:
    properties:
      created_at:
        type: string
      deactivated_at:
        type: string
      deletion_confirmed_at:
        type: string
      deletion_requested_at:
        type: string
      display_name:
        type: string
      email:
        type: string
      last_login_at:
        type: string
      public_id:
        type: string
      role:
        type: string
    type: object
  dto.UserListResponse:
    properties:
      limit:
        type: integer
      offset:
        type: integer
      total:
        type: integer
      users:
        items:
          $ref: '#/definitions/dto.AdminUserResponse'
        type: array
    type: object
  dto.UserResponse:
    properties:
      created_at:
        example: "2025-09-11T12:00:00Z"
        type: string
      email:
        example: user@example.com
        type: string
      public_id:
        example: uuid
        type: string
      role:
        example: user
        type: string
    type: object
  model.AuditAction:
    enum:
    - user_login
    - user_logout
    - user_created
    - user_updated
    - user_deactivated
    - user_reactivated
    - user_deleted
    - user_exported
    - role_changed
    - data_accessed
    - deletion_requested
    - deletion_confirmed
    - deletion_cancelled
    - data_anonymized
    - review_deleted
    type: string
    x-enum-varnames:
    - AuditActionUserLogin
    - AuditActionUserLogout
    - AuditActionUserCreated
    - AuditActionUserUpdated
    - AuditActionUserDeactivated
    - AuditActionUserReactivated
    - AuditActionUserDeleted
    - AuditActionUserExported
    - AuditActionRoleChanged
    - AuditActionDataAccessed
    - AuditActionDeletionRequested
    - AuditActionDeletionConfirmed
    - AuditActionDeletionCancelled
    - AuditActionDataAnonymized
    - AuditActionReviewDeleted
host: localhost:8080
info:
  contact:
    name: API Support
    url: https://github.com/leoferamos/aroma-sense
  description: REST API for user Aroma Sense Eccomerce
  title: Aroma Sense API
  version: "1.0"
paths:
  /admin/audit-logs:
    get:
      consumes:
      - application/json
      description: Get paginated list of audit logs with filters (user, actor, action,
        resource, date)
      parameters:
      - description: User ID
        in: query
        name: user_id
        type: integer
      - description: Actor ID
        in: query
        name: actor_id
        type: integer
      - description: Action type
        in: query
        name: action
        type: string
      - description: Resource type
        in: query
        name: resource
        type: string
      - description: Resource ID
        in: query
        name: resource_id
        type: string
      - description: Start date (RFC3339)
        in: query
        name: start_date
        type: string
      - description: End date (RFC3339)
        in: query
        name: end_date
        type: string
      - description: Limit
        in: query
        name: limit
        type: integer
      - description: Offset
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.AuditLogListResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List audit logs
      tags:
      - audit-log
  /admin/audit-logs/{id}:
    get:
      consumes:
      - application/json
      description: Get a specific audit log entry (masked emails)
      parameters:
      - description: Audit Log ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.AuditLogResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get audit log
      tags:
      - audit-log
  /admin/audit-logs/{id}/detailed:
    get:
      consumes:
      - application/json
      description: Get a specific audit log entry with full emails (admin/ops)
      parameters:
      - description: Audit Log ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.AuditLogResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get audit log (detailed)
      tags:
      - audit-log
  /admin/audit-logs/cleanup:
    post:
      consumes:
      - application/json
      description: Remove audit logs older than retention period (LGPD compliance)
      parameters:
      - description: Retention period in days
        in: query
        name: retention_days
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Cleanup old audit logs
      tags:
      - audit-log
  /admin/audit-logs/summary:
    get:
      consumes:
      - application/json
      description: Get summary/statistics of audit logs in a date range
      parameters:
      - description: Start date (RFC3339)
        in: query
        name: start_date
        type: string
      - description: End date (RFC3339)
        in: query
        name: end_date
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.AuditLogSummaryResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get audit log summary
      tags:
      - audit-log
  /admin/contestations:
    get:
      description: Returns all contestations with status 'pending' for admin review
      parameters:
      - description: Limit
        in: query
        name: limit
        type: integer
      - description: Offset
        in: query
        name: offset
        type: integer
      responses:
        "200":
          description: List of contestations and total count
          schema:
            additionalProperties: true
            type: object
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List pending user contestations
      tags:
      - admin-contestation
  /admin/contestations/{id}/approve:
    post:
      description: Approves a pending contestation and adds optional review notes
      parameters:
      - description: Contestation ID
        in: path
        name: id
        required: true
        type: integer
      - description: Review notes (optional)
        in: body
        name: body
        schema:
          type: object
      responses:
        "200":
          description: Contestation approved
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Approve a user contestation
      tags:
      - admin-contestation
  /admin/contestations/{id}/reject:
    post:
      description: Rejects a pending contestation and adds optional review notes
      parameters:
      - description: Contestation ID
        in: path
        name: id
        required: true
        type: integer
      - description: Review notes (optional)
        in: body
        name: body
        schema:
          type: object
      responses:
        "200":
          description: Contestation rejected
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Reject a user contestation
      tags:
      - admin-contestation
  /admin/orders:
    get:
      consumes:
      - application/json
      description: Returns paginated list of orders with optional filters (status,
        date range)
      parameters:
      - description: Filter by status
        in: query
        name: status
        type: string
      - description: Start date (YYYY-MM-DD)
        in: query
        name: start_date
        type: string
      - description: End date (YYYY-MM-DD)
        in: query
        name: end_date
        type: string
      - description: Page number (1-based)
        in: query
        name: page
        type: integer
      - description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.AdminOrdersResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List all orders
      tags:
      - admin
  /admin/products:
    get:
      consumes:
      - application/json
      description: Returns all products with IDs for admin management
      parameters:
      - default: 1
        description: Page number (1-based)
        in: query
        name: page
        type: integer
      - default: 50
        description: Items per page (default 50, max 200)
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Paginated product list with IDs
          schema:
            $ref: '#/definitions/dto.ProductListResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Admin list all products
      tags:
      - admin
      - products
    post:
      consumes:
      - multipart/form-data
      description: Creates a new product with image upload (Admin only)
      parameters:
      - description: Product name
        in: formData
        name: name
        required: true
        type: string
      - description: Product brand
        in: formData
        name: brand
        required: true
        type: string
      - description: Product weight in ml
        in: formData
        name: weight
        required: true
        type: number
      - description: Product description
        in: formData
        name: description
        type: string
      - description: Product price
        in: formData
        name: price
        required: true
        type: number
      - description: Product category
        in: formData
        name: category
        required: true
        type: string
      - description: Product notes (fragrance notes)
        in: formData
        name: notes
        required: true
        type: array
      - description: Stock quantity
        in: formData
        name: stock_quantity
        required: true
        type: integer
      - description: Product image
        in: formData
        name: image
        required: true
        type: file
      produces:
      - application/json
      responses:
        "201":
          description: Product created successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request (includes missing image)'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "403":
          description: 'Error code: unauthorized'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create a new product
      tags:
      - admin
  /admin/products/{id}:
    delete:
      consumes:
      - application/json
      description: Deletes an existing product (Admin only)
      parameters:
      - description: Product ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Product deleted successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "403":
          description: 'Error code: unauthorized'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete product
      tags:
      - admin
    patch:
      consumes:
      - application/json
      description: Updates an existing product (Admin only)
      parameters:
      - description: Product ID
        in: path
        name: id
        required: true
        type: integer
      - description: Product update data
        in: body
        name: product
        required: true
        schema:
          $ref: '#/definitions/dto.UpdateProductRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Product updated successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "403":
          description: 'Error code: unauthorized'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update product
      tags:
      - admin
  /admin/review-reports:
    get:
      description: List review reports filtered by status (pending/accepted/rejected)
      parameters:
      - default: pending
        description: Status filter
        enum:
        - pending
        - accepted
        - rejected
        in: query
        name: status
        type: string
      - default: 20
        description: Limit
        in: query
        name: limit
        type: integer
      - default: 0
        description: Offset
        in: query
        name: offset
        type: integer
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.ReviewReportAdminResponse'
        "400":
          description: 'Error code: invalid_status'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "403":
          description: 'Error code: unauthorized'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List review reports
      tags:
      - admin-review-reports
  /admin/review-reports/{id}/resolve:
    post:
      description: Accept or reject a review report. Accepting hides the review. Optionally
        deactivate the user later.
      parameters:
      - description: Report ID
        in: path
        name: id
        required: true
        type: string
      - description: Resolve payload
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/dto.ReviewReportResolveRequest'
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_action or invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "403":
          description: 'Error code: unauthorized'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: report_not_found or review_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "409":
          description: 'Error code: report_already_resolved'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Resolve a review report
      tags:
      - admin-review-reports
  /admin/users:
    get:
      consumes:
      - application/json
      description: Get paginated list of users with optional filters
      parameters:
      - default: 10
        description: Number of users per page
        in: query
        name: limit
        type: integer
      - default: 0
        description: Offset for pagination
        in: query
        name: offset
        type: integer
      - description: Filter by role (admin, client)
        in: query
        name: role
        type: string
      - description: Filter by status (active, deactivated, deleted)
        in: query
        name: status
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Users list
          schema:
            $ref: '#/definitions/dto.UserListResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List users for admin
      tags:
      - admin
  /admin/users/{id}:
    get:
      consumes:
      - application/json
      description: Get detailed information about a specific user
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: User details
          schema:
            $ref: '#/definitions/dto.AdminUserResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get user details for admin
      tags:
      - admin
  /admin/users/{id}/audit-logs:
    get:
      consumes:
      - application/json
      description: Get paginated audit logs for a specific user (masked emails)
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: integer
      - description: Limit
        in: query
        name: limit
        type: integer
      - description: Offset
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.AuditLogListResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get user audit logs
      tags:
      - audit-log
  /admin/users/{id}/deactivate:
    post:
      consumes:
      - application/json
      description: Soft delete user account for GDPR compliance with detailed reason
        and notes
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: integer
      - description: Deactivation details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.AdminDeactivateUserRequest'
      produces:
      - application/json
      responses:
        "200":
          description: User deactivated successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Deactivate user account
      tags:
      - admin
  /admin/users/{id}/reactivate:
    post:
      consumes:
      - application/json
      description: Reactivate a previously deactivated user account with reason
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: integer
      - description: Reactivation details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.AdminReactivateUserRequest'
      produces:
      - application/json
      responses:
        "200":
          description: User reactivated successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Reactivate user account
      tags:
      - admin
  /admin/users/{id}/role:
    patch:
      consumes:
      - application/json
      description: Change user role (admin/client) with admin confirmation
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: integer
      - description: New role
        in: body
        name: role
        required: true
        schema:
          $ref: '#/definitions/dto.UpdateRoleRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Role updated successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "403":
          description: 'Error code: cannot_change_own_role'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update user role
      tags:
      - admin
  /ai/chat:
    post:
      consumes:
      - application/json
      description: Send a message to the AI assistant and receive a conversational
        response with product suggestions
      parameters:
      - description: Chat message with optional session ID
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.ChatRequest'
      produces:
      - application/json
      responses:
        "200":
          description: AI response with reply and product suggestions
          schema:
            $ref: '#/definitions/dto.ChatResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "429":
          description: 'Error code: rate_limited'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Chat with AI assistant
      tags:
      - ai
  /ai/recommend:
    post:
      consumes:
      - application/json
      description: Returns personalized product recommendations based on user's fragrance
        preferences and message
      parameters:
      - description: Recommendation request with user message and limit
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.RecommendRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Product recommendations with reasoning
          schema:
            $ref: '#/definitions/dto.RecommendResponse'
        "400":
          description: 'Error code: invalid_request or topic_restricted'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "429":
          description: 'Error code: rate_limited'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Get AI product recommendations
      tags:
      - ai
  /cart:
    delete:
      consumes:
      - application/json
      description: Removes all items from the user's cart, returning an empty cart
      produces:
      - application/json
      responses:
        "200":
          description: Empty cart after clearing all items
          schema:
            $ref: '#/definitions/dto.CartResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: cart_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Clear cart
      tags:
      - cart
    get:
      consumes:
      - application/json
      description: Retrieves the shopping cart for the authenticated user with items,
        quantities and totals
      produces:
      - application/json
      responses:
        "200":
          description: User's cart with items and totals
          schema:
            $ref: '#/definitions/dto.CartResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: cart_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get current user's cart
      tags:
      - cart
    post:
      consumes:
      - application/json
      description: Adds a product to the user's shopping cart. If item already exists,
        increases quantity.
      parameters:
      - description: Product slug and quantity to add
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.AddToCartRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Updated cart with new item
          schema:
            $ref: '#/definitions/dto.CartResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: product_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "409":
          description: 'Error code: insufficient_stock'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Add item to cart
      tags:
      - cart
  /cart/items/{productSlug}:
    delete:
      consumes:
      - application/json
      description: Removes a specific item from the user's cart completely
      parameters:
      - description: Product slug
        in: path
        name: productSlug
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Updated cart after item removal
          schema:
            $ref: '#/definitions/dto.CartResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: cart_item_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Remove item from cart
      tags:
      - cart
    patch:
      consumes:
      - application/json
      description: Updates the quantity of a specific item in the user's cart. If
        quantity is 0, removes the item.
      parameters:
      - description: Product slug
        in: path
        name: productSlug
        required: true
        type: string
      - description: New quantity (0 to remove item)
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.UpdateCartItemRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Updated cart
          schema:
            $ref: '#/definitions/dto.CartResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: cart_item_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "409":
          description: 'Error code: insufficient_stock'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update cart item quantity
      tags:
      - cart
  /orders:
    get:
      consumes:
      - application/json
      description: Returns the list of orders for the authenticated user
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/dto.OrderResponse'
            type: array
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List user's orders
      tags:
      - orders
    post:
      consumes:
      - application/json
      description: Creates a new order from the user's cart, validates stock, deducts
        products, and clears the cart
      parameters:
      - description: Order data (shipping address, payment method)
        in: body
        name: order
        required: true
        schema:
          $ref: '#/definitions/dto.CreateOrderFromCartRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Order created successfully
          schema:
            $ref: '#/definitions/dto.OrderResponse'
        "400":
          description: 'Error code: invalid_request or cart_empty or insufficient_stock'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create a new order
      tags:
      - orders
  /products:
    get:
      consumes:
      - application/json
      description: If `query` is provided, returns a paginated search envelope; otherwise
        returns the latest products.
      parameters:
      - description: Search term (websearch syntax)
        in: query
        name: query
        type: string
      - default: 1
        description: Page number (1-based)
        in: query
        name: page
        type: integer
      - default: 10
        description: Items per page (default 10, max 100)
        in: query
        name: limit
        type: integer
      - default: relevance
        description: 'Sort order: relevance|latest'
        in: query
        name: sort
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Search results envelope (when query is present) or paginated
            latest (when query absent and page>1)
          schema:
            $ref: '#/definitions/dto.ProductListResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: List or search products
      tags:
      - products
  /products/{id}:
    get:
      consumes:
      - application/json
      description: Retrieves detailed information about a specific product
      parameters:
      - description: Product ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Product details
          schema:
            $ref: '#/definitions/dto.ProductResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: product_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Get product by ID
      tags:
      - products
  /products/{slug}:
    get:
      consumes:
      - application/json
      description: Retrieves a specific product by its slug for clean URLs
      parameters:
      - description: Product slug
        in: path
        name: slug
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Product details
          schema:
            $ref: '#/definitions/dto.ProductResponse'
        "404":
          description: 'Error code: product_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Get product by slug
      tags:
      - products
  /products/{slug}/reviews:
    get:
      consumes:
      - application/json
      description: Returns published reviews for a product in descending creation
        order.
      parameters:
      - description: Product slug
        in: path
        name: slug
        required: true
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 10
        description: Items per page
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Paginated reviews
          schema:
            $ref: '#/definitions/dto.ReviewListResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: product_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: List product reviews
      tags:
      - reviews
    post:
      consumes:
      - application/json
      description: Creates a review for a delivered product. Requires authentication,
        a display_name set, and at least one delivered order containing the product.
        One review per user/product.
      parameters:
      - description: Product slug
        in: path
        name: slug
        required: true
        type: string
      - description: Review payload
        in: body
        name: review
        required: true
        schema:
          $ref: '#/definitions/dto.ReviewRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Review created
          schema:
            $ref: '#/definitions/dto.ReviewResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "403":
          description: 'Error code: profile_incomplete or not_delivered'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: product_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "409":
          description: 'Error code: already_reviewed'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create product review
      tags:
      - reviews
  /products/{slug}/reviews/summary:
    get:
      consumes:
      - application/json
      description: Returns average rating, total review count, and rating distribution
        for a product.
      parameters:
      - description: Product slug
        in: path
        name: slug
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Review summary
          schema:
            $ref: '#/definitions/dto.ReviewSummary'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: product_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Get product review summary
      tags:
      - reviews
  /reviews/{reviewID}:
    delete:
      consumes:
      - application/json
      description: Soft deletes a review created by the authenticated user. Only the
        review author can delete their own review. The review data is retained for
        compliance purposes but marked as deleted and no longer visible.
      parameters:
      - description: Review ID (UUID)
        in: path
        name: reviewID
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Review deleted successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "403":
          description: 'Error code: unauthorized'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: review_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete product review
      tags:
      - reviews
  /reviews/{reviewID}/report:
    post:
      consumes:
      - application/json
      description: Allows an authenticated user to report a review for abuse (spam/offensive/improper/other).
        Prevents self-reporting and duplicate reports per user.
      parameters:
      - description: Review ID (UUID)
        in: path
        name: reviewID
        required: true
        type: string
      - description: Report payload
        in: body
        name: report
        required: true
        schema:
          $ref: '#/definitions/dto.ReviewReportRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Review reported successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request or invalid_category or reason_too_long'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "403":
          description: 'Error code: cannot_report_own_review'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: 'Error code: review_not_found'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "409":
          description: 'Error code: already_reported'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Report a review
      tags:
      - reviews
  /shipping/options:
    get:
      description: Returns a list of shipping options (carrier, service code, price,
        ETA) for the current cart.
      parameters:
      - description: Destination postal code (CEP)
        in: query
        name: postal_code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/dto.ShippingOption'
            type: array
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List shipping options
      tags:
      - shipping
  /users/change-password:
    post:
      consumes:
      - application/json
      description: Allows authenticated users to change their password by providing
        current and new password
      parameters:
      - description: Bearer token
        in: header
        name: Authorization
        required: true
        type: string
      - description: Password change request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.ChangePasswordRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Password changed successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request or current_password_incorrect'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Change user password
      tags:
      - users
  /users/login:
    post:
      consumes:
      - application/json
      description: Authenticates a user and returns a JWT token and user info.
      parameters:
      - description: Login credentials
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/dto.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Authentication successful
          schema:
            $ref: '#/definitions/dto.LoginResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Login
      tags:
      - auth
  /users/logout:
    post:
      description: Invalidates refresh token and clears refresh cookie.
      responses:
        "200":
          description: Logout successful
          schema:
            $ref: '#/definitions/dto.MessageResponse'
      summary: Logout
      tags:
      - auth
  /users/me:
    get:
      description: Returns the authenticated user's profile information.
      produces:
      - application/json
      responses:
        "200":
          description: User profile
          schema:
            $ref: '#/definitions/dto.ProfileResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get my profile
      tags:
      - users
  /users/me/contest:
    post:
      consumes:
      - application/json
      description: User can contest their account deactivation within 7 days
      parameters:
      - description: Contestation details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.ContestationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Contestation requested successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "403":
          description: 'Error code: contestation_deadline_expired or account_not_deactivated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Request account deactivation contestation
      tags:
      - users
  /users/me/deletion:
    post:
      consumes:
      - application/json
      description: Initiates account deletion process with 7-day cooling off period
        (LGPD compliance)
      parameters:
      - description: Deletion confirmation
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.DeleteAccountRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Deletion request initiated successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request or active_orders_block_deletion'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Request account deletion
      tags:
      - users
  /users/me/deletion/cancel:
    post:
      consumes:
      - application/json
      description: Cancels a pending account deletion request during cooling off period
      produces:
      - application/json
      responses:
        "200":
          description: Account deletion cancelled
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: deletion_not_requested'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Cancel account deletion
      tags:
      - users
  /users/me/export:
    get:
      consumes:
      - application/json
      description: Download all personal data for GDPR portability right
      produces:
      - application/json
      responses:
        "200":
          description: User data exported
          schema:
            $ref: '#/definitions/dto.UserExportResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Export user data
      tags:
      - users
  /users/me/profile:
    patch:
      consumes:
      - application/json
      description: Updates profile fields such as display_name.
      parameters:
      - description: Profile update
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/dto.UpdateProfileRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Updated profile
          schema:
            $ref: '#/definitions/dto.ProfileResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: unauthenticated'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update my profile
      tags:
      - users
  /users/refresh:
    post:
      description: Uses the HttpOnly refresh_token cookie to issue a new short-lived
        access token.
      produces:
      - application/json
      responses:
        "200":
          description: Token refreshed
          schema:
            $ref: '#/definitions/dto.LoginResponse'
        "400":
          description: 'Error code: refresh_token_missing'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: 'Error code: invalid_refresh_token or refresh_token_expired'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Refresh access token
      tags:
      - auth
  /users/register:
    post:
      consumes:
      - application/json
      description: Creates a new user account with the provided information.
      parameters:
      - description: User registration data
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/dto.CreateUserRequest'
      produces:
      - application/json
      responses:
        "201":
          description: User registered successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request or email_already_registered'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Register a new user
      tags:
      - auth
  /users/reset/confirm:
    post:
      consumes:
      - application/json
      description: Validates the reset code and updates the user's password. Returns
        generic errors to avoid revealing whether email/code exists.
      parameters:
      - description: Reset confirmation data
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/dto.ResetPasswordConfirmRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Password reset successfully
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request or reset_code_invalid'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "429":
          description: 'Error code: rate_limited'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Confirm password reset
      tags:
      - auth
  /users/reset/request:
    post:
      consumes:
      - application/json
      description: Sends a 6-digit code to the user's email if it exists. Always returns
        success to avoid revealing whether the email is registered.
      parameters:
      - description: Email address
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/dto.ResetPasswordRequestRequest'
      produces:
      - application/json
      responses:
        "200":
          description: If the email exists, a reset code has been sent
          schema:
            $ref: '#/definitions/dto.MessageResponse'
        "400":
          description: 'Error code: invalid_request'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "429":
          description: 'Error code: rate_limited'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: 'Error code: internal_error'
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      summary: Request password reset
      tags:
      - auth
securityDefinitions:
  BearerAuth:
    description: Type "Bearer" followed by a space and JWT token.
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
